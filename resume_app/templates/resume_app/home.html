<!DOCTYPE html>
<html>
<head>
    <title>Smart Resume Analyzer & Builder</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container mt-5">
    <div class="card shadow p-4">

        <h2 class="text-center mb-4">Smart Resume Analyzer & Builder</h2>

        <!-- Resume Analyzer Form -->
        <form method="POST" enctype="multipart/form-data">
            {% csrf_token %}

            <h5 class="mb-3 text-primary">Resume Analyzer</h5>

            <!-- Role Selection -->
            <div class="mb-3">
                <label class="form-label">Target Job Role</label>
                <select name="role" class="form-select">
                    <option value="backend" {% if selected_role == "backend" %}selected{% endif %}>Backend Developer</option>
                    <option value="data_analyst" {% if selected_role == "data_analyst" %}selected{% endif %}>Data Analyst</option>
                    <option value="ai_engineer" {% if selected_role == "ai_engineer" %}selected{% endif %}>AI Engineer</option>
                </select>
            </div>

            <!-- Resume Upload -->
            <div class="mb-3">
                <label class="form-label">Upload Resume (PDF/DOCX)</label>
                <input type="file" name="resume" class="form-control" required>
            </div>

            <!-- Job Description -->
            <div class="mb-3">
                <label class="form-label">Job Description</label>
                <textarea name="job_description" class="form-control" rows="5" required>{{ job_description }}</textarea>
            </div>

            <button type="submit" class="btn btn-primary w-100 mb-3">Analyze Resume</button>
        </form>

        <!-- ATS Score & Suggestions -->
        {% if ats_score != None %}
        <hr>
        <div class="mb-3">
            <h5 class="fw-bold">ATS Match Score</h5>
            <div class="progress mb-2">
                <div class="progress-bar {% if ats_score >= 80 %}bg-success{% elif ats_score >= 60 %}bg-warning{% else %}bg-danger{% endif %}"
                     role="progressbar"
                     style="width: {{ ats_score }}%;">
                    {{ ats_score }}%
                </div>
            </div>

            {% if missing_keywords %}
            <div class="alert alert-warning">
                <strong>Missing Keywords:</strong> {{ missing_keywords|join:", " }}
            </div>
            {% endif %}

            {% if section_scores %}
            <div class="mb-2">
                <h6>Section Scores:</h6>
                <ul>
                    <li>Skills: {{ section_scores.skills }}%</li>
                    <li>Experience: {{ section_scores.experience }}%</li>
                    <li>Education: {{ section_scores.education }}%</li>
                </ul>
            </div>
            {% endif %}

            {% if suggestions %}
            <div class="alert alert-info">
                <ul class="mb-0">
                    {% for suggestion in suggestions %}
                    <li>{{ suggestion }}</li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}
        </div>
        {% endif %}

        <!-- Divider -->
        <div class="text-center my-4">
            <span class="text-muted fw-bold">OR</span>
        </div>

        <!-- Resume Builder -->
        <div class="text-center mb-3">
            <h5 class="mb-3 text-success">Resume Builder</h5>
            <a href="{% url 'resume_builder' %}">
                <button class="btn btn-outline-success btn-lg w-100 mb-2">
                    Build Resume from Scratch
                </button>
            </a>
        </div>

    </div>
</div>

</body>
</html>
